# Ｃ言語とは
<div style="text-align:right">(Wikipediaより)</div><br>

*C言語*（シーげんご）は、1972年にAT&Tベル研究所のデニス・リッチーが主体となって開発したプログラミング言語である。英語圏では単に *C* と呼んでおり、日本でも文書や文脈によっては同様に C と呼ぶことがある。

## 特徴
* 汎用性が高い。プログラムの自由度や、目的に応じた拡張が容易であるため、パソコンソフトからゲームの作成、機械制御やシステム管理など、あらゆる分野に適応している。
* 対応する機器の範囲が広い。パソコンはもちろん、自動車や家電の組込み用マイコンからスーパーコンピュータまで、C言語を使用できるハードウェアは多様である。多目的性と、対応機器の多彩さのため、「コンピュータを使ってやること」は大抵、C言語で対応可能である。
* 商用・非商用を問わず、採用ソフトウェア分野が広い。作成や使用のための補助的なソフトウェアが豊富である。
* 機械語に変換するソフトなどの開発環境がCPUに付属していたり無償だったりするものもあるため、ライセンス料の支払いをしなくても使用が始められる。
* 開発時期が古く、文法に機械語の影響が強く、複雑である。この欠点を補正するためのちに開発された新言語に比較し、記述することが多く、面倒で習得しにくい低級言語である。(IT用語における低水準、低級、低レベルという表現は、機械語やアセンブリ言語のように、ハードウェアの動作をより直接的に記述できる（あるいはしなければならない）ことを指す。C言語に関しては、ポインタを通じて直接的にメモリ操作を行うことができる点などで、Javaなどに比べて低級であると言える（反対にJavaはC言語に対して高レベルな言語である）。通常、低級言語と高級言語は動作環境や生産性などに応じて使い分けられている。低級、高級という表現は誤解を招きがちだが、*プログラミング言語としての質を指す言葉ではない* ことには注意が必要である。)
* アマチュアからプロ技術者まで、プログラマ人口が多く、プログラマのコミュニティが充実している。C言語は使用者の多さから、正負の両面含め、プログラミング文化に大きな影響を及ぼしている。
* 言語の適用先であるUNIXの場合、大抵のことがスクリプト言語・マクロプロセッサやフィルタやそれらの組み合わせで処理できるため、うまく分野の棲み分けができていた面があった。仕様規格・派生言語も多く幅広い領域への移植の結果、適切でない分野にC言語が使われている場合もある。
* C言語は手続き型言語の側面と関数型言語の側面がある。コンパイラ言語とOSを念頭に設計している。アセンブラのコードと同じことを実現できるようなコンピュータ寄りの言語仕様になっている。低水準な記述が出来る高級言語とも、高級言語の顔をした低級言語と言うことがある。
* C コンパイラは、移植の容易性、自由度、実行速度、コンパイル速度などを追求した。代わりにコンパイル後のコードの安全性を犠牲にしている。セキュリティーの脆弱性や潜んだバグによる想定外の動作、コンパイラによる最適化の難しさがある。最適化するとコンパイル速度が遅くなるなどの欠点が生じることがある。自動車分野ではMISRA-CというC言語部分集合（subset）を定義して、C言語の弱点を補っている。
* UNIXおよび C コンパイラの移植性を高めるために開発してきた経緯から、オペレーティングシステムカーネルおよびコンパイラ向けの低水準記述ができる。

### 自由度

* 文の区切りを終端記号 セミコロン「;」で表し、改行文字にも空白にもトークンの区切りとしての意味しか持たせない「フリーフォーマット」という形式を採用している。
  * 記述作法について、しばしば議論の対象となり、本も多数出版。
* ALGOL の思想を受け継いで *構造化プログラミング* に対応している。手順を入れ子構造で示して見通しの良い記述をすることができる。原理的に *無条件分岐*（```goto文```）を使用する必要はなく、MISRA-Cでは当初goto文を禁止していた。goto文を使わなければ、*スパゲティプログラム* と呼ばれる読みにくいプログラムになりにくい。
*  モジュール化がファイルを単位として可能。モジュール内だけで有効な名前を使うことが出来るスコープを持っている。
*   プログラムを戻り値つきのサブルーチンに分離できる。C言語ではこれを関数と呼び、関数内のプログラムコードでは、独立した変数が使用できる。これにより、データの流れがブロックごとに完結し、デバッグが容易になり、また関数の再帰呼び出しも可能となる。また、多人数での共同開発の際にも変数名の衝突が回避しやすくなる。なお、C言語ではUNIXのようなOSを前提としたホスト環境と、割り込み制御のようなOSを前提としないフリースタンディング環境とがある。ホスト環境では、プログラム開始直後に実行するプログラム要素を main という名前の関数として定義する。フリースタンディング環境では、エントリポイントと呼ばれるアドレスに置かれたコードをプログラムの開始点とするが、それがmain関数である必要はない。なお再帰呼び出しは、スタックオーバフローの原因となるため、MISRA-Cでは禁止している。
* C言語では、main関数と、標準ライブラリのprintf, scanf 関数（およびその類型の関数）は、引数が可変という特殊な性格の関数である。K&Rでは、この特殊な関数mainとprintfを使った例を最初に示している。
*  システム記述言語として開発されたため、高級言語であるがアセンブラ的な低水準の操作ができる。ポインタ演算、ビットごとの論理演算、シフト演算などの機能を持ち、ハードウェアに密着した処理を効率よく記述できる。これはオペレーティングシステムやドライバなどを記述する上では便利であるが、注意深く利用しないと発見しにくいバグの原因となる。ライブラリ関数は、C言語規格が規定している関数と、OSが規定している関数との間の整合性、棲み分けなどが流動的である。MISRA-Cのようないくつかの制約では、C言語規格が規定している関数の妥当性について指摘し、いくつかの関数を利用しないように規定している。
*  配列とポインタとでは、宣言の仕方と領域確保の仕組みは異なっているが、配列アクセスそのものは、ポインタ演算および間接参照と同等である。
 ポインタを配列表記でアクセスすることや、配列をポインタ表記でアクセスすることができる糖衣構文がある。
 MISRA-Cでは、応用ソフトを記述することが目的であるため、ポインタの利用を禁止している。
*  ソースコードの記述に使う文字集合はANSI-C:1989(ISO/IEC 9899:1990)ではASCIIを標準としている。他のISO 646でも書けるように、3文字利用したトライグラフと呼ばれる表記法も存在する。その後、ISO/IEC 9899:1995 AMDなどでは多バイト対応の拡張を規定している。さらに、その後トライグラフは複数のコードを利用したシステムでしか利用がないため、より分かり易い2文字によるダイグラフを規定している。

### アセンブラとのインターフェース
* 多くの処理系がインラインアセンブラを搭載しているほか、アセンブラで出力したオブジェクトとのリンクが容易になっている。これにより速度が要求される部分だけをアセンブリ言語で記述するということが容易に行えることが多い。アセンブラとのインターフェースは#pragma asmなどを用いて局所化を図る努力はあるが、コンパイラごとに定義があり、CPU が同一であっても移植性が低い場合がある。

### コンパイラ仕様
*  コンパイラの処理が1パスで済む仕様になっている。ANSI-C:1989では宣言のない変数はintを想定することになっていた。ISO/IEC C:1999以降では変数はその使用より前に宣言する必要がある。関数の宣言がないと、戻り値や引数をint型とみなす仕様は、自由な発想を促すプログラミングの視点で好ましいが、型検査・型証明の仕組みが十分にないと不具合の原因になることがある。後継言語では記述によって先読みが必要になりうる。
* マクロ記述やコンパイル条件の指定などが出来る前処理指令が標準化されている。前処理指令の解釈をするプリプロセッサを持っている。プリプロセッサ（preprocesser）は、その名の通りコンパイル処理の前に自動的に実行される。コンパイラの機能として、プリプロセッサを通しただけの段階のソースコードを出力可能になっているものがある。前処理の結果を検査することで、設計者の意図と前処理の結果のずれがないか確認できる。

### 処理系の簡素化  <br>
 ホスト環境やプログラムの内容によっては、以下に対して脆弱性対策を施しても実行速度の低下が無視できる程度であることも多く、欠点とみなされることも少なくない。
* 配列参照時の自動的な添字のチェックをしない
これを要因とする代表的なバグがバッファオーバーフロー（固定長のバッファをはみだして上書きが行われてしまう）である。標準ライブラリにはバッファオーバーフローを考慮していない関数があり、かつ多用されがちなため、しばしば脆弱性の原因となる。また、プログラムにより制御する事で可変長配列を可能にしている。

* 文字列を格納するための特別な型が存在しない
 文字列にはchar型の配列を利用する。言語仕様上に特別な扱いはないが、ヌル文字（\0）を終端とする文字列表現を使い、その操作をする標準ライブラリ関数がある。これは実質的にメモリ領域のポインタアクセスそのもので、固定長バッファに対して、それより長い可変長の文字列を書き込んでしまうことがあり、バッファオーバーランの元凶の1つとなっている。後継言語では文字列処理を特に強化している場合が多い。

* 自動変数の自動的な初期化をしない
 自動変数（静的でないローカル変数）は変数の中でも最も頻繁に用いられる。初期化されていない変数を参照した場合、値は不定となるが、不定な値へのアクセスは未定義の動作であるので、コンパイラ最適化の過程で想定しない形に改変することもある。変数宣言・初期化の仕様による制限から、変数宣言の時点で初期化せず後で代入することで初期化に代えることが日常的で、誤って不定の値の変数を読み出すバグを作り込みやすい。なお自動変数の自動とは 変数の領域の確保と開放が自動であるという意味であり、自動的に初期化されるという意味ではない。

### その他
* 文字の大文字・小文字を区別する。
* 入出力を含めほとんどの機能が、C言語自身で書かかれたライブラリによって提供される。このことは、C言語の機種依存性が低く、入出力関係ライブラリをのぞいた部分は移植性（ポータビリティ）が高いことを意味する。さまざまな機種があるUNIXの世界でC言語が普及した理由のひとつである。
* プログラムの実行に必要とするハードウェア資源が、アセンブラよりは多いが他の高級言語より少なくてすむため、現在さまざまな電化製品などの組み込みシステムでも使用されている。
* 組込み向けの場合は、プログラミング言語として、アセンブラ以外では、C と C++ しか用意していないことがある。その場合、他のプログラミング言語は、C や C++ で書かれた処理系が存在すれば、コンパイルすることにより利用可能となることもあるが、メモリ制約などで動作しないことがある。

### コード例
Hello world プログラム

C言語の Hello world プログラムには、ホスト環境を前提とするか、フリースタンディング環境を前提とするかで、方向性が異なる。入門書によって趣が異なるいくらかの方向性が存在する。ホスト環境を前提とする場合には、入出力の利用により、動作をすぐに確かめることができる。標準Cライブラリ ```stdio.h```の```printf```関数を利用したものを例示する場合、以下のようなものがある。

``` c
#include <stdio.h>

int main(void){
    printf("Hello, world!\n");
    return 0;
}
```

ここでサンプルソース中の「```\n```」は改行を表す。なお、```printf``` 関数は変数や書式化された文字列などが表示できる比較的高機能な出力関数である。C言語として可変引数である特殊なmainとprintfを使っていることにより、C言語の関数プログラミングに対する誤解を生む原因にもなっている。

===主な制御構造===
* ```do-while文```
* ```for文```
* ```goto文```
* ```if文```
* ```return文```
* ```switch文```
* ```while文```
* ```関数```

## 歴史  
### 誕生  
C言語は、AT&T ベル研究所のケン・トンプソンが開発したB言語の改良として誕生した。

 1973年、トンプソンとUNIXの開発を行っていたデニス・リッチーは B 言語を改良し、実行可能な機械語を直接生成するC言語のコンパイラを開発した。UNIX は大部分をC言語によって書き換え、C言語のコンパイラ自体も移植性の高い実装の Portable C Compiler に置き換わったこともあり、UNIX上のプログラムはその後にC言語を広く利用するようになった。

### UNIX環境とC言語  

アセンブラとの親和性が高いために、ハードウェアに密着したコーディングがやりやすかったこと、言語仕様が小さいためコンパイラの開発が楽だったこと、小さな資源で動く実行プログラムを作りやすかったこと、UNIX環境での実績があり、後述の K&R といった解説文書が存在していたことなど、さまざまな要因からC言語は業務開発や情報処理研究での利用者を増やしていった。特にメーカー間でオペレーティングシステムやCPUなどのアーキテクチャが違う UNIX 環境では再移植の必要性がしばしば生じて、プログラムをC言語で書いてソースレベル互換を確保することが標準となった。

### パソコンとC言語  

 1980年代に普及し始めたパーソナルコンピュータは当初、8ビットCPUでROM-BASICを搭載していたものも多く、BASICが普及していたが、80年代後半以降、16ビットCPUを採用しメモリも増えた（ROM-BASIC 非搭載の）パソコンが主流になりだすと、2万円前後の安価なコンパイラが存在したこともあり、ユーザーが急増した。8ビットや8086系のパソコンへの移植は、ポインタなどに制限や拡張を加えることで解決していた。

### 現在のC言語  

 1990年代中盤以降は、最初に学ぶプログラミング言語としても主流となった。GUI環境の普及とオブジェクト指向の普及により Java、Objective-C、C++、PHP、Visual Basic、などの言語の利用者も増加したため、広く利用されるプログラミング言語の数は増加傾向にある。現在でもJava, C#, C++などC言語の後続言語を含めて、C言語は比較的移植性に優れた言語であり、業務用開発やフリーソフトウェア開発、C++ などの実装が困難な組み込みなどの小規模のシステムで、幅広く利用されている。

##C言語の規格  
### K&R  

 リッチーとカーニハンの共著である「The C Programming Language」1978年を出版。その後標準ができるまで実質的なC言語の標準として参照。C言語は発展可能な言語で、この本の記述も発展の可能性のある部分は厳密な記述をしておらず、曖昧な部分が存在していた。C言語が普及するとともに、互換性のない処理系が数多く誕生した。これはプログラミング言語でしばしば起こる現象であり、C言語固有の現象ではない。

### C89/C90  

そこで、国際標準化機構(ISO)/IEC JTC1と米国国家規格協会(ANSI) は協同でC言語の規格の標準化を進め、1989年12月に ANSI が ANSI X3.159-1989, American National Standard for Information Systems -Programming Language-C を、1990年12月に ISO が INTERNATIONAL STANDARD ISO/IEC 9899 : 1990(E) Programming Languages-C を発行した。ISO/IEC 規格のほうが章立てを追加しており、その後 ANSI も ISO/IEC 規格にならって章立てを追加した。それぞれ C89（ANSI C89）及び ISO/IEC C90 という通称で呼ぶことがある。
日本では、これを翻訳したものを日本工業規格『JIS X3010-1993 プログラム言語C』として、1993年10月に制定した。

最大の特徴は、C++ と同様の関数プロトタイプ を導入して引数の型チェックを強化したことと、```void``` や ```enum``` などの新しい型を導入したことである。一方、処理系に依存するとするに留めた部分も幾つかある（```int``` 型のビット幅、```char``` 型の符号、ビットフィールドのエンディアン、シフト演算の挙動、構造体などへのパディング、等）。

16bit/32bitCPUの両方に対応できるようにするため、定義しないことを決めている未定義、定義したもののどれにするかを決めていない未規定、処理系ごとに決めて文書化する処理系定義など、CPUとの相性による有利不利が生じないような規定になっている
型の大きさは16bit/32bitCPUの両方に対応できるように決めている。バイト数は ```sizeof``` 演算子で取得し、最大最小値は ```limits.h``` で参照することとしている。多くの処理系では ```char``` 型は 8 ビット、```short``` 型は16ビットである。```int``` や ```long``` はCPUのレジスタの幅などによって決めている。また API などの呼び出しには、ヘッダで ```BYTE``` や ```WORD``` などと ```typedef``` で定義した型を使用して回避することがある。```char``` 型以外で符号を明示しない場合は ```signed```（符号付き）にするかどうかも処理系。

### C99

1999年12月1日に、ISO/IEC JTC1 SC22 WG14 で規格の改定を行い、C++ の機能のいくつかを取り込むことを含め機能を拡張しISO/IEC 9899:1999(E) Programming Language--C (Second Edition) を制定した。この版のC言語の規格を、通称としてC99と呼ぶ。
日本では、日本工業規格 JIS X 3010:2003「プログラム言語C」がある。

日本では、日本工業規格 JIS X 3010:2003「プログラム言語C」がある。

主な追加機能：
* 変数宣言がブロックの先頭でなくても良くなった。
* ブール代数を扱うための ```_Bool``` 型が予約語に追加され、標準ライブラリーとして ```stdbool.h``` を追加した。
* 複素数を扱うための ```_Complex``` 型や ```_Imaginary``` 型を予約語に追加し、標準ライブラリーとして ```complex.h``` を追加した。
* 64 ビット整数値を保持できる ```long long int``` 型の追加。
* ```//``` による1行コメント。
* インライン関数（```inline``` キーワード）。
* 可変長配列（```alloca``` 関数の代替）

### C11

2011年12月8日に改定された *ISO/IEC 9899:2011* （通称 *C11*）が現在の最新規格である。gcc や Clang などが部分的に対応している。改定による変更・追加・削除機能の一部を以下に記述する。

C11 はUnicode文字列（UTF-32、UTF-16、UTF-8 の各符号化方式）に標準で対応している。そのほか、```type-generic``` 式、C++ と同様の無名構造体・無名共用体、排他的アクセスによるファイルオープン方法、quick_exitなどのいくつかの標準関数などを追加した。

gets 関数は廃止  

### 主なC言語処理系

gcc, clang, Visual C++, C++Builderなど著名な４つがC言語と C++を一つの処理系で対応している。C言語とC++の共通部分を明確にし、二つの言語の違いに矛盾が生じないようにすることが課題になっている。

### Linux、Windows、UNIX 用

* GNUコンパイラコレクション （GCC）
C・C++ 以外の言語もサポートし、多数の CPU やオペレーティングシステムに対応、組み込み向けも含む多様な開発に広く使われるオープンソースのコンパイラ。

* clang
LLVM をバックエンドとして用いるオープンソースのC言語・C++・Objective-C コンパイラ。多数の CPU に対応。

* Microsoft Visual C++
Windows 系プラットフォーム用のC言語・C++ コンパイラ。2013 から C99 におおむね対応。x86・x64 が主だが Xbox 360、Windows CE 等向けに PowerPC、ARM、MIPS、Itanium 等に対応した版もある。前身として MS-DOS・Windows 用の Microsoft C Compiler がある。またその廉価版として Quick C があった。

* C++ Builder
Windows 用の x86 用C言語・C++ のコンパイラ。RAD。前身は DOS、Windows 用の Borland C/C++。さらに前身として Turbo C/C++ がある。

### 組み込み用、8ビット・16ビット・32ビット・64ビットCPU用（クロスコンパイラ）

* CodeWarrior C/C++
組み込み向けやゲーム機開発向けのC言語・C++ コンパイラ。Mac OS 用として発祥、かっては Windows 用・BeOS 用・Palm 用もあった。

* ARM C/C++
armCPU用C言語・C++ コンパイラ。

* High C
元は x86 向けでPC/AT互換機用だが 80386 のネイティブモードに対応したため FM TOWNS でも標準開発環境、「High C 386」として使用された。現在は各社RISC向け。

* BDS-C
CP/M（8080・Z80）用のサブセット(整数のみ)の K&R 系のC言語コンパイラ。現在はパブリックドメインソフトウェア。

* Hitech-C
Z80、PICなど。

* Lattice C
1980年代に、日本で高い普及率を見せたコンパイラ。解説書も多く出版されていた。日本での発売はライフボート。初期版はマイクロソフトCコンパイラ1.0として発売された。商用利用のできない個人向けの「personal」版も販売されており、これの価格は 19,800 円であった。

* LSI C
8080・Z80用の LSI C-80（セルフ版・クロス版。現在はクロス版のみ）と、8086 用の LSI C-86 がある。8086 では機能限定（スモールモデルのプログラムしか開発できず、デバッガがない）の「試食版」がフリーソフトで公開され、広く使われた。

## 関連するプログラミング言語
### 先祖
* ALGOL
ヨーロッパ生まれのアルゴリズム記述言語。Pascal やC言語などに影響を与えたとされる。
* BCPL
MULTICS で作成された高級言語。
* B言語
初期の UNIX で作成されたインタプリタ方式の高級言語。BCPLを元に作られ、Cの原型となった。

### 継承・拡張・サブセット
* C++
C言語を拡張してオブジェクト指向化したもの。当初はC言語のスーパーセットだったが、現在は細かい部分において非互換仕様が増えている。

* Java
C++よりも言語文法レベルでオブジェクト指向を重視した言語。バッファオーバーランなどの危険性が高いポインタといったローレベルな要素を言語文法から排除している。仮想マシン（Java VM, JVM）上で動作する。

* C#
Microsoftが.NET Framework向けに開発した言語。文法はC言語およびC++に近い書式を持ち、Javaと似ている部分も存在するが、機能的にはDelphiがベースとなっている。

* Objective-C
C言語を拡張してオブジェクト指向化したもの。C言語に Smalltalk のオブジェクトシステムを取り付けたような設計で、互換性は保たれている。C言語からの拡張部分が C++ と干渉しないため、C++ と混在した記述が可能。

* Unified Parallel C
並列計算向けに C99 を拡張して作られた言語。

### 系統図

C 言語 と その流れを引く言語への系統図です。C が多くの言語へ影響を与えていることが分かります。

![ruby_and_c.jpg](ruby_and_c.jpg)
> [初めてのRuby](https://www.amazon.co.jp/初めてのRuby-Yugui/dp/4873113679?ie=UTF8&hvadid=88610427195&hvdev=c&hvexid=&hvnetw=g&hvpone=&hvpos=1t1&hvptwo=&hvqmt=b&hvrand=16291889983092297804&ref=pd_sl_373lofzev_b&tag=googhydr-22), Yugui(著), オライリージャパン より引用
